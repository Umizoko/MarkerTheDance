!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=function(){var e=0,t=document.createElement("div");function n(e){return t.appendChild(e.dom),e}function i(n){for(var o=0;o<t.children.length;o++)t.children[o].style.display=o===n?"block":"none";e=n}t.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",t.addEventListener("click",function(n){n.preventDefault(),i(++e%t.children.length)},!1);var a=(performance||Date).now(),r=a,l=0,s=n(new o.Panel("FPS","#0ff","#002")),c=n(new o.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=n(new o.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:t,addPanel:n,showPanel:i,begin:function(){a=(performance||Date).now()},end:function(){l++;var e=(performance||Date).now();if(c.update(e-a,200),e>=r+1e3&&(s.update(1e3*l/(e-r),100),r=e,l=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:t,setMode:i}};o.Panel=function(e,t,n){var o=1/0,i=0,a=Math.round,r=a(window.devicePixelRatio||1),l=80*r,s=48*r,c=3*r,u=2*r,d=3*r,f=15*r,p=74*r,h=30*r,m=document.createElement("canvas");m.width=l,m.height=s,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*r+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,l,s),g.fillStyle=t,g.fillText(e,c,u),g.fillRect(d,f,p,h),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(d,f,p,h),{dom:m,update:function(s,w){o=Math.min(o,s),i=Math.max(i,s),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,l,f),g.fillStyle=t,g.fillText(a(s)+" "+e+" ("+a(o)+"-"+a(i)+")",c,u),g.drawImage(m,d+r,f,p-r,h,d,f,p-r,h),g.fillRect(d+p-r,f,r,h),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(d+p-r,f,r,a((1-s/w)*h))}}};class i{constructor(e,t,n,o){this._filename=e,this._scene=t,this._group=n,this._mixier,this._clock=new THREE.Clock,this._textureCube=o,this._meshName="SkinnedMesh"}init(){(new THREE.FBXLoader).load(this._filename,e=>{e.mixier=new THREE.AnimationMixer(e),this._mixier=e.mixier,e.mixier.clipAction(e.animations[0]).play(),e.scale.set(.01,.01,.01),this._group.add(e),e.children.map((e,t)=>{e.type===this._meshName&&(e.material.envMap=this._textureCube,e.material.shininess=90,e.material.reflectivity=.8,e.castShadow=!0)})})}update(){this._mixier&&this._mixier.update(this._clock.getDelta())}}class a{constructor(e,t,n){this.context=e,this.urlList=t,this.onload=n,this.bufferList=new Array,this.loadCount=0}loadBuffer(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer";var o=this;n.onload=function(){o.context.decodeAudioData(n.response,function(n){n?(o.bufferList[t]=n,++o.loadCount==o.urlList.length&&o.onload(o.bufferList)):alert("error decoding file data: "+e)},function(e){console.error("decodeAudioData error",e)})},n.onerror=function(){alert("BufferLoader: XHR error")},n.send()}load(){for(var e=0;e<this.urlList.length;++e)this.loadBuffer(this.urlList[e],e)}}class r{constructor(e,t){this.playNow=this.createSource(e,t),this.source=this.playNow.source,this.gainNode=this.playNow.gainNode,this.source.start(0),this.gainNode.gain.value=0}createSource(e,t){var n=t.createBufferSource(),o=t.createGain();return n.buffer=e,n.loop=!0,n.connect(o),o.connect(t.destination),{source:n,gainNode:o}}volumeFadeIn(){this.gainNode.gain.value<=1&&(this.gainNode.gain.value+=.01)}volumeFadeOut(){this.gainNode.gain.value>0?this.gainNode.gain.value-=.01:this.gainNode.gain.value<0&&(this.gainNode.gain.value+=.01)}}class l{constructor(e){this.canvas=document.getElementById(e)}init(){const e=new THREE.Scene,t=new THREE.WebGLRenderer({canvas:document.querySelector("#threeCanvas"),antialias:!0,alpha:!0});t.setClearColor(new THREE.Color("black"),0);const n=document.querySelector("#threeCanvas");let o=n.clientWidth,l=n.clientHeight;t.setSize(o,l),t.gammaOutput=!0,t.gammaInput=!0,t.shadowMap.enabled=!0;const s=new THREE.Camera;e.add(s);const c=new THREEx.ArToolkitSource({sourceType:"webcam"});c.init(function(){E()});const u=new THREEx.ArToolkitContext({debug:!1,cameraParametersUrl:"ar/camera_para.dat",detectionMode:"mono",imageSmoothingEnabled:!0,maxDetectionRate:30,canvasWidth:c.parameters.sourceWidth,canvasHeight:c.parameters.sourceHeight});u.init(function(){s.projectionMatrix.copy(u.getProjectionMatrix())});const d=new THREE.Group;e.add(d);new THREEx.ArMarkerControls(u,d,{size:1,type:"pattern",patternUrl:"ar/hiro.patt"});const f="./assets/env/Lycksele2/",p=(new THREE.CubeTextureLoader).load([f+"posx.jpg",f+"negx.jpg",f+"posy.jpg",f+"negy.jpg",f+"posz.jpg",f+"negz.jpg"]),h=new i("./assets/robot/WaveHipHopDance.fbx",e,d,p);h.init(),window.AudioContext=window.AudioContext||window.webkitAudioContext;const m=new AudioContext;let g;new a(m,["./assets/sound/Go_to_the_camp.mp3"],function(e){const t=m.createBufferSource();t.buffer=e[0],t.connect(m.destination),g=new r(t.buffer,m)}).load();const w=new THREE.AmbientLight(16777215,.2);d.add(w);const v=new THREE.DirectionalLight(16777215,1);v.castShadow=!0,v.position.y=4,v.shadow.mapSize.width=2048,v.shadow.mapSize.height=2048,d.add(v);const y=new THREE.Mesh(new THREE.BoxGeometry(2,.1,2),new THREE.MeshStandardMaterial({color:16777215,roughness:0,metalness:1}));function E(){c.onResizeElement(),c.copyElementSizeTo(t.domElement),null!==u.arController&&c.copyElementSizeTo(u.arController.canvas)}y.position.y=-.05,y.receiveShadow=!0,d.add(y),function n(){requestAnimationFrame(n);if(!1===c.ready)return;u.update(c.domElement);!0===u.arController.patternMarkers[0].inCurrent?g.volumeFadeIn():g.volumeFadeOut();h.update();t.render(e,s);window.addEventListener("resize",function(){E()})}()}}window.addEventListener("load",()=>{new l("threeCanvas").init()})}]);
//# sourceMappingURL=bundle.js.map